; Конфигурация усиленной безопасности для PHP 8.3
; Этот файл включается только при SECURITY_HARDENING=true

; Отключить опасные функции (может быть переопределено через переменную DISABLE_DANGEROUS_FUNCTIONS)
disable_functions = exec,passthru,shell_exec,system,proc_open,popen,parse_ini_file,show_source,pcntl_exec,pcntl_fork,pcntl_signal,pcntl_waitpid,pcntl_alarm,posix_kill,posix_mkfifo,posix_setpgid,posix_setsid,posix_setuid,dl,symlink,chgrp,leak,apache_child_terminate,proc_close,proc_get_status,proc_nice,proc_terminate

; Усиление безопасности
expose_php = Off
allow_url_include = Off
enable_dl = Off

; Безопасность сессий
session.cookie_httponly = 1
session.use_only_cookies = 1
session.use_trans_sid = 0

; Только в режиме production
display_errors = Off
display_startup_errors = Off

; Ограничение доступа к файлам
open_basedir = /var/www/bitrix:/tmp:/usr/share/php:/var/log/php

; Примечание: curl_exec и curl_multi_exec НЕ отключены по умолчанию,
; так как они могут требоваться модулями Битрикс